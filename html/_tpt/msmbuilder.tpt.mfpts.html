

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>msmbuilder.tpt.mfpts &mdash; MSMBuilder 3.8.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/msmb.css?v=51bd699f" />

  
      <script src="../_static/documentation_options.js?v=fb7e056b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/js/versions.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Continuous-time MSMs" href="../ratematrix.html" />
    <link rel="prev" title="msmbuilder.tpt.conditional_committors" href="msmbuilder.tpt.conditional_committors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo-200px.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../featurization.html">Featurization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feature_selection.html">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../decomposition.html">Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cluster.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msm.html">Markov state models (MSMs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gmrq.html">Model Selection using GMRQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tpt.html">Transition Path Theory</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tpt.html#references">References</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tpt.html#functions">Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.fluxes.html">msmbuilder.tpt.fluxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.net_fluxes.html">msmbuilder.tpt.net_fluxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.fraction_visited.html">msmbuilder.tpt.fraction_visited</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.hub_scores.html">msmbuilder.tpt.hub_scores</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.paths.html">msmbuilder.tpt.paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.top_path.html">msmbuilder.tpt.top_path</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.committors.html">msmbuilder.tpt.committors</a></li>
<li class="toctree-l3"><a class="reference internal" href="msmbuilder.tpt.conditional_committors.html">msmbuilder.tpt.conditional_committors</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">msmbuilder.tpt.mfpts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#msmbuilder.tpt.mfpts"><code class="docutils literal notranslate"><span class="pre">mfpts()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ratematrix.html">Continuous-time MSMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hmm.html">Hidden Markov models (HMMs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apipatterns.html">API Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Writing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MSMBuilder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tpt.html">Transition Path Theory</a></li>
      <li class="breadcrumb-item active">msmbuilder.tpt.mfpts</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_tpt/msmbuilder.tpt.mfpts.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="msmbuilder-tpt-mfpts">
<h1>msmbuilder.tpt.mfpts<a class="headerlink" href="#msmbuilder-tpt-mfpts" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="msmbuilder.tpt.mfpts">
<span class="sig-prename descclassname"><span class="pre">msmbuilder.tpt.</span></span><span class="sig-name descname"><span class="pre">mfpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msmbuilder.tpt.mfpts" title="Link to this definition">¶</a></dt>
<dd><p>Gets the Mean First Passage Time (MFPT) for all states to a <em>set</em>
of sinks.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>msm</strong><span class="classifier">msmbuilder.MarkovStateModel</span></dt><dd><p>MSM fit to the data.</p>
</dd>
<dt><strong>sinks</strong><span class="classifier">array_like, int, optional</span></dt><dd><dl class="simple">
<dt>Indices of the sink states. There are two use-cases:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>None [default]<span class="classifier">All MFPTs will be calculated, and the</span></dt><dd><p>result is a matrix of the MFPT from state i to state j.
This uses the fundamental matrix formalism.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>list of ints or int<span class="classifier">Only the MFPTs into these sink</span></dt><dd><p>states will be computed. The result is a vector, with
entry i corresponding to the average time it takes to
first get to <em>any</em> sink state from state i</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>lag_time</strong><span class="classifier">float, optional</span></dt><dd><p>Lag time for the model. The MFPT will be reported in whatever
units are given here. Default is (1) which is in units of the
lag time of the MSM.</p>
</dd>
<dt><strong>errors</strong><span class="classifier">bool, optional</span></dt><dd><p>Pass “True” if you want to calculate a distribution of MFPTs accounting for MSM model error due to finite 
sampling</p>
</dd>
<dt><strong>n_samples</strong><span class="classifier">int, optional</span></dt><dd><p>If “errors” is True, this is the number of MFPTs you want to compute (default = 100). 
For each computation, all nonzero transition probabilities (i,j) will be treated as 
Gaussian random variables, with mean equal to the transition probability and standard 
deviation equal to the standard errot of the mean of the binomial distribution with 
n observations, where n is the row-summed counts of row i.</p>
<p>NOTE: This implicitly assumes the Central Limit Theorem is a good approximation for the error, 
so this method works best with well-sampled data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mfpts</strong><span class="classifier">np.ndarray, float</span></dt><dd><p>MFPT in time units of lag_time, which depends on the input
value of sinks:</p>
<ul class="simple">
<li><dl class="simple">
<dt>If sinks is None, then mfpts’s shape is (n_states, n_states).</dt><dd><p>Where mfpts[i, j] is the mean first passage time to state j
from state i.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If sinks contains one or more states, then mfpts’s shape</dt><dd><p>is (n_states,). Where mfpts[i] is the mean first passage
time from state i to any state in sinks.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rf5dd7b75a2a2-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Grinstead, C. M. and Snell, J. L. Introduction to
Probability. American Mathematical Soc., 1998.</p>
</div>
</div>
<dl class="simple">
<dt>As of November 2014, this chapter was available for free online:</dt><dd><p><a class="reference external" href="http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/Chapter11.pdf">http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/Chapter11.pdf</a></p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="msmbuilder.tpt.conditional_committors.html" class="btn btn-neutral float-left" title="msmbuilder.tpt.conditional_committors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ratematrix.html" class="btn btn-neutral float-right" title="Continuous-time MSMs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, Stanford University and the Authors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'http://msmbuilder.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        3.8.6
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>