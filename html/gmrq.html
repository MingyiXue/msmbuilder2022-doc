

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Selection using GMRQ &mdash; MSMBuilder 3.8.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/msmb.css?v=51bd699f" />

  
      <script src="_static/documentation_options.js?v=fb7e056b"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/js/versions.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="msmbuilder.decomposition.tICA.score" href="_gmrq/msmbuilder.decomposition.tICA.score.html" />
    <link rel="prev" title="msmbuilder.msm.BayesianMarkovStateModel" href="_msm/msmbuilder.msm.BayesianMarkovStateModel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo-200px.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="background.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="featurization.html">Featurization</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_selection.html">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="decomposition.html">Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="msm.html">Markov state models (MSMs)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model Selection using GMRQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#algorithms">Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="_gmrq/msmbuilder.decomposition.tICA.score.html">msmbuilder.decomposition.tICA.score</a></li>
<li class="toctree-l3"><a class="reference internal" href="_gmrq/msmbuilder.msm.MarkovStateModel.score.html">msmbuilder.msm.MarkovStateModel.score</a></li>
<li class="toctree-l3"><a class="reference internal" href="_gmrq/msmbuilder.msm.ContinuousTimeMSM.score.html">msmbuilder.msm.ContinuousTimeMSM.score</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tpt.html">Transition Path Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratematrix.html">Continuous-time MSMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm.html">Hidden Markov models (HMMs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="apipatterns.html">API Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Writing Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MSMBuilder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model Selection using GMRQ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/gmrq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-selection-using-gmrq">
<span id="gmrq"></span><h1>Model Selection using GMRQ<a class="headerlink" href="#model-selection-using-gmrq" title="Link to this heading">¶</a></h1>
<p>The generalized matrix Rayleigh quotient (GMRQ) is a specific application of
the variational principle (adapted from <a class="reference external" href="https://en.wikipedia.org/wiki/Variational_method_(quantum_mechanics)">quantum mechanics</a>)
for Markov state models and a useful tool for model parameter selection.</p>
<p>The variational principle yields a rigorous way of comparing two different
Markov models for the same underlying stochastic process when using different
state decompositions. Even under the assumption that you have access to
infinite sampling, there is still some error associated with approximating the
true continuous eigenfunctions of your modeled process with the indicator
functions, as is the case with Markov state models. If we interpret the
variational theorem as the measure of the quality of this approximation, the
state decomposition that leads to a Markov model with larger leading dynamical
eigenvalues is consequently the better state decomposition. If you wish to see
the full derivation of this quantity, please refer to <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>Using this method, we can generate single scalar-valued scores for a proposed
model given a supplied data set. This allows for the use of separate testing
and training data sets to quantify and avoid statistical overfitting.
This method extends these tools, making it possible to score trained models on
new datasets and to perform hyperparameter selection.</p>
<section id="algorithms">
<h2>Algorithms<a class="headerlink" href="#algorithms" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_gmrq/msmbuilder.decomposition.tICA.score.html#msmbuilder.decomposition.tICA.score" title="msmbuilder.decomposition.tICA.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decomposition.tICA.score</span></code></a>(sequences[, y])</p></td>
<td><p>Score the model on new data using the generalized matrix Rayleigh quotient</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_gmrq/msmbuilder.msm.MarkovStateModel.score.html#msmbuilder.msm.MarkovStateModel.score" title="msmbuilder.msm.MarkovStateModel.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msm.MarkovStateModel.score</span></code></a>(sequences[, y])</p></td>
<td><p>Score the model on new data using the generalized matrix Rayleigh quotient</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_gmrq/msmbuilder.msm.ContinuousTimeMSM.score.html#msmbuilder.msm.ContinuousTimeMSM.score" title="msmbuilder.msm.ContinuousTimeMSM.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msm.ContinuousTimeMSM.score</span></code></a>(sequences[, y])</p></td>
<td><p>Score the model on new data using the generalized matrix Rayleigh quotient</p></td>
</tr>
</tbody>
</table>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>McGibbon, Robert T., and Vijay S. Pande. <a class="reference external" href="http://dx.doi.org/10.1063/1.4916292">Variational cross-validation of slow dynamical modes in molecular kinetics</a> J. Chem. Phys. 142, 124105 (2015).</p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_msm/msmbuilder.msm.BayesianMarkovStateModel.html" class="btn btn-neutral float-left" title="msmbuilder.msm.BayesianMarkovStateModel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="_gmrq/msmbuilder.decomposition.tICA.score.html" class="btn btn-neutral float-right" title="msmbuilder.decomposition.tICA.score" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, Stanford University and the Authors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'http://msmbuilder.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        3.8.6
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>